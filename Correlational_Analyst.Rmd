---
title: "Correlation Analysis of Air Pollutants"
author: "Randini Amarathunga"
date: "2025-08-31"
output: html_document
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code.

# DS202.3 â€“ Data Programming with R

## Correlational Analyst

This R Notebook contains the data preparation, Exploratory data analysis and visualizations for Correlational Analyst.In this analysis,I focus on exploring relationships between different air pollutants and testing whether one pollutant can reliably predict another using the WHO Ambient Air Quality dataset (2024).

### 1.Data Preparation

```{r}
# download the essential packages

install.packages("GGally")
install.packages("corrplot")
```

```{r}
library(tidyverse)  # data manipulation and visualization
library(corrplot)   # correlation matrices
library(GGally)     # correlation plots
library(readxl)     # read excel files
```

```{r}
# load the dataset

air_data <- read_excel("who_ambient_air_quality_database_version_2024_(v6.1).xlsx", sheet = "Update 2024 (V6.1) (2)")
```

```{r}
# Check structure of dataset

str(air_data)
```



```{r}
# Getting count of null values in dataset

colSums(is.na(air_data))
```



```{r}
# Drop the unnecessary columns

air_data <- air_data %>%
  select(-pm10_tempcov, -pm25_tempcov, -no2_tempcov, -web_link, -reference, -version, -population_source)
```

```{r}
str(air_data)
```



```{r}
# Confirm if there any null values still there

colSums(is.na(air_data))
```



```{r}
# converting data type to factor

air_data <- air_data %>%
  mutate(
    who_region = as.factor(who_region),
    country_name = as.factor(country_name),
    city = as.factor(city),
    type_of_stations = as.factor(type_of_stations)
  )
```



```{r}
str(air_data)
```

```{r}
# convert the data type of key pollutant to numeric

air_data <- air_data %>%
  mutate(
    pm10_concentration = as.numeric(pm10_concentration),
    pm25_concentration = as.numeric(pm25_concentration),
    no2_concentration  = as.numeric(no2_concentration)
  )
```



```{r}
# Drop rows with missing values in pollutant variables

air_data <- air_data %>%
  drop_na(pm10_concentration, pm25_concentration, no2_concentration)
```


```{r}
colSums(is.na(air_data))
```



```{r}
# Check if there any duplicated values in dataset

sum(duplicated(air_data))
```






###2. Exploratory Data Analysis (EDA) 

```{r}
# Summary statistics for key pollutants

summary(air_data %>% 
          select(pm10_concentration, pm25_concentration, no2_concentration))
```



```{r}
# checking distribution of each pollutant

ggplot(air_data, aes(x = pm25_concentration)) +
  geom_histogram(bins = 30, fill = "#90EE90", color = "black") +
  labs(title = "Distribution of PM2.5", x = "PM2.5", y = "Frequency")

ggplot(air_data, aes(x = pm10_concentration)) +
  geom_histogram(bins = 30, fill = "#FFB6C1", color = "black") +
  labs(title = "Distribution of PM10", x = "PM10", y = "Frequency")

ggplot(air_data, aes(x = no2_concentration)) +
  geom_histogram(bins = 30, fill = "#ADD8E6", color = "black") +
  labs(title = "Distribution of NO2", x = "NO2", y = "Frequency")
```




```{r}
# Boxplot for identifying outliers

air_data %>%
  pivot_longer(cols = c(pm25_concentration, pm10_concentration, no2_concentration),
               names_to = "pollutant", values_to = "value") %>%
  ggplot(aes(x = pollutant, y = value, fill = pollutant)) +
  geom_boxplot() +
  labs(title = "Boxplots of PM2.5, PM10, and NO2",
       x = "Pollutant", y = "Concentration")
```


```{r}
# Visualize relationships between two pollutants

ggplot(air_data, aes(x = pm25_concentration, y = pm10_concentration)) +
  geom_point(color = "blue", alpha = 0.6) +
  labs(title = "Scatterplot of PM2.5 vs PM10",
       x = "PM2.5 concentration",
       y = "PM10 concentration")
```





```{r}
# calculate the average pollutant concentrations by WHO region (understanding the regional differences in air quality level)

air_data %>%
  group_by(who_region) %>%
  summarise(
    avg_pm25 = mean(pm25_concentration, na.rm = TRUE),
    avg_pm10 = mean(pm10_concentration, na.rm = TRUE),
    avg_no2  = mean(no2_concentration, na.rm = TRUE)
  )

```




```{r}
# distribution of key pollutants across different WHO regions (smooth view of distribution)

ggplot(air_data, aes(x = pm25_concentration, fill = who_region)) +
  geom_density(alpha = 0.5) +
  labs(title = "PM2.5 Density by WHO Region")

ggplot(air_data, aes(x = pm10_concentration, fill = who_region)) +
  geom_density(alpha = 0.5) +
  labs(title = "PM10 Density by WHO Region")
```


```{r}
# scatterplot for identify the relationship between PM2.5, PM10 across different regions & check if the patterns are consistent or region-specific.

ggplot(air_data, aes(x = pm25_concentration, y = pm10_concentration)) +
  geom_point(alpha = 0.5, color = "blue") +
  facet_wrap(~who_region) +
  labs(title = "PM2.5 vs PM10 by WHO Region",
       x = "PM2.5 concentration", 
       y = "PM10 concentration")

```




```{r}

```









